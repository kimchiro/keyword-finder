# ë„¤ì´ë²„ ìŠ¤í¬ë˜í•‘ ê°œì„  ìš”êµ¬ì‚¬í•­

## ğŸ” í˜„ì¬ ë¬¸ì œì  ë¶„ì„

### 1. ì¸ê¸°ì£¼ì œ í‚¤ì›Œë“œ ìˆ˜ì§‘ ì‹¤íŒ¨
- **ë¬¸ì œ**: `net::ERR_ABORTED` ì˜¤ë¥˜ë¡œ í˜ì´ì§€ ë¡œë”© ì‹¤íŒ¨
- **ì›ì¸**: ë„¤ì´ë²„ ê²€ìƒ‰ ê²°ê³¼ì— ì¸ê¸°ì£¼ì œ ì„¹ì…˜ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤ì›Œë“œ
- **í˜„ìƒ**: "ì´ˆì½œë¦¿", "ë§›ì§‘" í‚¤ì›Œë“œ ê²€ìƒ‰ ì‹œ ì¸ê¸°ì£¼ì œ ì˜ì—­ ë¶€ì¬

### 2. ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨  
- **ë¬¸ì œ**: ë™ì¼í•œ `net::ERR_ABORTED` ì˜¤ë¥˜
- **ì›ì¸**: í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ì»¨í…ì¸  ë¶€ì¬
- **í˜„ìƒ**: ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ì˜ì—­ì´ í™”ë©´ì— í‘œì‹œë˜ì§€ ì•ŠìŒ

### 3. ì—°ê´€ê²€ìƒ‰ì–´ëŠ” ì •ìƒ ë™ì‘
- **ì„±ê³µ**: ì—°ê´€ê²€ìƒ‰ì–´ëŠ” ì •ìƒì ìœ¼ë¡œ 2ê°œì”© ìˆ˜ì§‘ë¨
- **ë°ì´í„°**: "íŠ¹ë³„í•œ ì¶”ì„", "ì¥ì†Œ ê¸°ë¡ì„ ë†’ì´ ì‚½ë‹ˆë‹¤" ë“±

## ğŸ¯ ê°œì„  ìš”êµ¬ì‚¬í•­

### A. ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”

#### 1. ìš”ì†Œ ì¡´ì¬ ì—¬ë¶€ ì‚¬ì „ í™•ì¸
```typescript
// ê°œì„  ì „: ë¬´ì¡°ê±´ ìŠ¤í¬ë˜í•‘ ì‹œë„
await this.page.goto(searchUrl);
const elements = await this.page.$$(selector);

// ê°œì„  í›„: ìš”ì†Œ ì¡´ì¬ í™•ì¸ í›„ ì²˜ë¦¬
await this.page.goto(searchUrl);
const hasSmartBlock = await this.page.$('.smartblock_area') !== null;
if (!hasSmartBlock) {
  console.log('âš ï¸ ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ì˜ì—­ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');
  return { keywords: [], message: 'ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤' };
}
```

#### 2. êµ¬ì²´ì ì¸ ë©”ì‹œì§€ ë°˜í™˜
- **ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë¶€ì¬**: "í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
- **ì¸ê¸°ì£¼ì œ ë¶€ì¬**: "í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ ì¸ê¸°ì£¼ì œ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"
- **í•¨ê»˜ì°¾ëŠ”í‚¤ì›Œë“œ ë¶€ì¬**: "í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ í•¨ê»˜ì°¾ëŠ”í‚¤ì›Œë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤"

### B. ì—°ê´€ê²€ìƒ‰ì–´ ìˆ˜ì§‘ í™•ì¥

#### 1. 2í˜ì´ì§€ ê²€ìƒ‰ ë¡œì§ ì¶”ê°€
```typescript
// 1í˜ì´ì§€ì—ì„œ ì—°ê´€ê²€ìƒ‰ì–´ ìˆ˜ì§‘
let relatedKeywords = await this.scrapeRelatedFromPage(1);

// 1í˜ì´ì§€ì—ì„œ ì¶©ë¶„í•˜ì§€ ì•Šìœ¼ë©´ 2í˜ì´ì§€ ì´ë™
if (relatedKeywords.length < maxResults) {
  console.log('ğŸ”„ ì—°ê´€ê²€ìƒ‰ì–´ ì¶”ê°€ ìˆ˜ì§‘ì„ ìœ„í•´ 2í˜ì´ì§€ë¡œ ì´ë™');
  const page2Keywords = await this.scrapeRelatedFromPage(2);
  relatedKeywords = [...relatedKeywords, ...page2Keywords];
}
```

#### 2. í˜ì´ì§€ë„¤ì´ì…˜ ì²˜ë¦¬
- 2í˜ì´ì§€ URL: `https://search.naver.com/search.naver?query=${query}&start=10`
- í˜ì´ì§€ë³„ ìµœëŒ€ ìˆ˜ì§‘ëŸ‰ ì œí•œ
- ì¤‘ë³µ í‚¤ì›Œë“œ ì œê±° ë¡œì§ ê°•í™”

## ğŸ› ï¸ êµ¬í˜„ ë°©ì•ˆ

### 1. ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ê°œì„ 
```typescript
async scrapeSmartBlockData(query: string): Promise<ScrapingResult> {
  try {
    await this.page.goto(searchUrl);
    
    // ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ì˜ì—­ ì¡´ì¬ í™•ì¸
    const smartBlockExists = await this.page.$('.api_subject_bx, .smartblock, .knowledge_box') !== null;
    
    if (!smartBlockExists) {
      return {
        keywords: [],
        message: `"${query}" í‚¤ì›Œë“œì— ëŒ€í•œ ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤`,
        status: 'no_content'
      };
    }
    
    // ê¸°ì¡´ ìŠ¤í¬ë˜í•‘ ë¡œì§ ì‹¤í–‰
    // ...
  } catch (error) {
    return {
      keywords: [],
      message: `ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`,
      status: 'error'
    };
  }
}
```

### 2. ì¸ê¸°ì£¼ì œ ê°œì„ 
```typescript
async scrapeTrendingKeywords(query: string): Promise<ScrapingResult> {
  try {
    await this.page.goto(searchUrl);
    
    // ì¸ê¸°ì£¼ì œ ì˜ì—­ ì¡´ì¬ í™•ì¸
    const trendingExists = await this.page.$('.trend_keyword, .popular_keyword, .issue_keyword') !== null;
    
    if (!trendingExists) {
      return {
        keywords: [],
        message: `"${query}" í‚¤ì›Œë“œì— ëŒ€í•œ ì¸ê¸°ì£¼ì œ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤`,
        status: 'no_content'
      };
    }
    
    // ê¸°ì¡´ ìŠ¤í¬ë˜í•‘ ë¡œì§ ì‹¤í–‰
    // ...
  } catch (error) {
    return {
      keywords: [],
      message: `ì¸ê¸°ì£¼ì œ ìˆ˜ì§‘ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ${error.message}`,
      status: 'error'
    };
  }
}
```

### 3. ì—°ê´€ê²€ìƒ‰ì–´ 2í˜ì´ì§€ í™•ì¥
```typescript
async scrapeRelatedSearchKeywords(query: string, maxResults: number = 10): Promise<ScrapingResult> {
  const allKeywords: ScrapedKeyword[] = [];
  
  // 1í˜ì´ì§€ ìˆ˜ì§‘
  const page1Results = await this.scrapeRelatedFromPage(query, 1);
  allKeywords.push(...page1Results.keywords);
  
  // 2í˜ì´ì§€ ìˆ˜ì§‘ (1í˜ì´ì§€ì—ì„œ ë¶€ì¡±í•œ ê²½ìš°)
  if (allKeywords.length < maxResults && allKeywords.length > 0) {
    console.log('ğŸ”„ ì—°ê´€ê²€ìƒ‰ì–´ ì¶”ê°€ ìˆ˜ì§‘ì„ ìœ„í•´ 2í˜ì´ì§€ë¡œ ì´ë™');
    const page2Results = await this.scrapeRelatedFromPage(query, 2);
    allKeywords.push(...page2Results.keywords);
  }
  
  return {
    keywords: allKeywords.slice(0, maxResults),
    message: `ì—°ê´€ê²€ìƒ‰ì–´ ${allKeywords.length}ê°œ ìˆ˜ì§‘ ì™„ë£Œ (1-2í˜ì´ì§€)`,
    status: 'success'
  };
}

private async scrapeRelatedFromPage(query: string, page: number): Promise<ScrapingResult> {
  const start = (page - 1) * 10;
  const searchUrl = `https://search.naver.com/search.naver?query=${encodeURIComponent(query)}&start=${start}`;
  
  await this.page.goto(searchUrl);
  // ì—°ê´€ê²€ìƒ‰ì–´ ìˆ˜ì§‘ ë¡œì§
  // ...
}
```

## ğŸ“Š ì‘ë‹µ êµ¬ì¡° ê°œì„ 

### ê¸°ì¡´ ì‘ë‹µ
```json
{
  "success": true,
  "data": {
    "keywords": [...],
    "totalKeywords": 2
  }
}
```

### ê°œì„ ëœ ì‘ë‹µ
```json
{
  "success": true,
  "data": {
    "keywords": [...],
    "totalKeywords": 2,
    "collectionDetails": {
      "trending": {
        "status": "no_content",
        "message": "í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ ì¸ê¸°ì£¼ì œ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
        "count": 0
      },
      "smartblock": {
        "status": "no_content", 
        "message": "í•´ë‹¹ í‚¤ì›Œë“œì— ëŒ€í•œ ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤",
        "count": 0
      },
      "related_search": {
        "status": "success",
        "message": "ì—°ê´€ê²€ìƒ‰ì–´ 2ê°œ ìˆ˜ì§‘ ì™„ë£Œ (1-2í˜ì´ì§€)",
        "count": 2,
        "pages": [1, 2]
      }
    }
  }
}
```

## ğŸ”§ êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ì˜ˆì™¸ ì²˜ë¦¬ ê°•í™”
1. ìš”ì†Œ ì¡´ì¬ ì—¬ë¶€ ì‚¬ì „ í™•ì¸ ë¡œì§ ì¶”ê°€
2. êµ¬ì²´ì ì¸ ë©”ì‹œì§€ ë°˜í™˜ êµ¬ì¡° ê°œì„ 
3. ì—ëŸ¬ í•¸ë“¤ë§ ì„¸ë¶„í™”

### Phase 2: ì—°ê´€ê²€ìƒ‰ì–´ í™•ì¥
1. 2í˜ì´ì§€ ìŠ¤í¬ë˜í•‘ ë¡œì§ êµ¬í˜„
2. í˜ì´ì§€ë„¤ì´ì…˜ ì²˜ë¦¬
3. ì¤‘ë³µ ì œê±° ë¡œì§ ê°•í™”

### Phase 3: ëª¨ë‹ˆí„°ë§ ê°œì„ 
1. ìˆ˜ì§‘ ìƒíƒœë³„ í†µê³„ ì¶”ê°€
2. ì‹¤íŒ¨ ì›ì¸ë³„ ë¶„ë¥˜
3. ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼

1. **ì•ˆì •ì„± í–¥ìƒ**: ì˜ˆì™¸ ìƒí™©ì—ì„œë„ ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ ì œê³µ
2. **ì •ë³´ íˆ¬ëª…ì„±**: ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ ìƒíƒœ ì •ë³´ ì œê³µ  
3. **ìˆ˜ì§‘ë¥  í–¥ìƒ**: 2í˜ì´ì§€ í™•ì¥ìœ¼ë¡œ ì—°ê´€ê²€ìƒ‰ì–´ ìˆ˜ì§‘ëŸ‰ ì¦ê°€
4. **ì‚¬ìš©ì ê²½í—˜**: ì‹¤íŒ¨ ì›ì¸ì„ ëª…í™•íˆ ì•Œ ìˆ˜ ìˆì–´ ëŒ€ì•ˆ ê²€ìƒ‰ ê°€ëŠ¥

## ğŸ“ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

### 1. ìŠ¤ë§ˆíŠ¸ë¸”ë¡ ë¶€ì¬ í…ŒìŠ¤íŠ¸
- í‚¤ì›Œë“œ: "ã…ã„´ã…‡ã„¹123" (ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤ì›Œë“œ)
- ì˜ˆìƒ ê²°ê³¼: no_content ìƒíƒœì™€ ëª…í™•í•œ ë©”ì‹œì§€

### 2. ì¸ê¸°ì£¼ì œ ë¶€ì¬ í…ŒìŠ¤íŠ¸  
- í‚¤ì›Œë“œ: "ì´ˆì½œë¦¿", "ë§›ì§‘" 
- ì˜ˆìƒ ê²°ê³¼: no_content ìƒíƒœì™€ ëª…í™•í•œ ë©”ì‹œì§€

### 3. ì—°ê´€ê²€ìƒ‰ì–´ 2í˜ì´ì§€ í…ŒìŠ¤íŠ¸
- í‚¤ì›Œë“œ: "ë§›ì§‘" (ì—°ê´€ê²€ìƒ‰ì–´ê°€ ë§ì€ í‚¤ì›Œë“œ)
- ì˜ˆìƒ ê²°ê³¼: 1-2í˜ì´ì§€ì—ì„œ ìˆ˜ì§‘ëœ í‚¤ì›Œë“œ ëª©ë¡

### 4. ì „ì²´ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸
- í‚¤ì›Œë“œ: "ã…ã„´ã…‡ã„¹" (ëª¨ë“  ì˜ì—­ì—ì„œ ë°ì´í„° ì—†ìŒ)
- ì˜ˆìƒ ê²°ê³¼: ê° ì˜ì—­ë³„ no_content ìƒíƒœ ë©”ì‹œì§€